---
title: "2022 Chippewa County Cover Crop Summary"
author: "Kolby Grint"
date: "2022-12-07"
output: html_document
---

```{r, echo= FALSE}
#loading packages
library(tidyverse)
library(readxl)
library(janitor)
library(unheadr)
library(ggplot2)
library(sf)
library(dplyr)
library(tibble)

```

```{r}
getwd()
#gettting data from local file
data1 = read_excel("2022CCSurvey_1.xlsx") %>% 
  clean_names() 

```
# 1. What Chippewa County township(s) do you farm in?
```{r}
#Chippewa County Township Shapefile
Chip_shp= st_read("Towns")
```


```{r}
#filtering data to townships and then counting # of responses for each township
townships <- data1 %>% 
  select(township) %>%
  separate_rows(township, sep = ",") %>%
  count(township, sort = TRUE) %>%
  rename(farmers = n)
```

```{r}
#Joining township counts to shapefile information including areas with no response
Chip_shp = Chip_shp %>%
  left_join(townships, by = c("NAME" = "township")) %>%
  mutate(farmers = ifelse(is.na(farmers), 0, farmers))
```

```{r, fig.height = 8, fig.width = 12}
#plotting the map with scale fill based on # of responses for each township
Q1_plot = ggplot(Chip_shp, aes(fill = farmers)) +
  geom_sf() +
  scale_fill_gradient2(midpoint = 3, mid = "green3", low = "white", high = "green4") +
  #annotate(geom = "text", ) +
  geom_sf_label(aes(label = NAME), size = 4) +
  theme(plot.title = element_text(size = 20),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        legend.text = element_text(size = 14),
        legend.title = element_text(size = 14)) +
  labs(title = "Farmer Use of 2022 Cost-Share for Chippewa County WI Townships")

Q1_plot
```

```{r}
ggsave("CCTownships_2022.png", plot = Q1_plot, height = 8, width = 12, dpi = 300)
```


# 2. Total number of 2022 cropland acres & 3. Total number of 2022 fall cover crops planted
```{r}
#what do we want? 
#plot raw total cropland and total cover crop acres planted.
#average percent of total acres cover cropped for farms participating would be interesting.

```

# 4. Previous crops
```{r}
Q4 = data1 %>%
  separate_rows(prior_crops, sep = ",") %>%
  count(prior_crops, sort= TRUE) %>%
  rename(response = prior_crops) 

#trying to get a count on the number of responses for a certain variable
Q4_n = data1 %>%
  select(respondent, prior_crops) %>%
  filter(!is.na(prior_crops)) 

#count(Q4_n,respondents)
 
```

```{r, fig.height = 5, fig.width = 7}
Q4_plot = Q4 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "gold3") +
  geom_text(aes(label= n), nudge_y= 0.75, size = 5) +
  theme_gray() +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,22), breaks = c(0,5,10,15,20)) +
  labs(title= "Previous Crop(s)", y = "# of responses") + #look at using caption to add sample size
  coord_flip()

Q4_plot
```

```{r}
ggsave("PreviousCrop_2022.png", plot = Q4_plot, height = 5, width = 7, dpi = 300)
```

# 5. 20222 cover crop planting date range
```{r}
planting_date1 = data1 %>%
  select(respondent, firstplant_date, dec_height) %>%
  mutate(plant_date = as.Date(firstplant_date)) %>%
  select(respondent, plant_date, dec_height)

planting_date2 = data1 %>%
  select(respondent, lastplant_date, dec_height) %>%
  mutate(plant_date = as.Date(lastplant_date)) %>%
  select(respondent, plant_date, dec_height)

planting_date = rbind(planting_date1,planting_date2) %>%
  filter(!is.na(plant_date)) %>%
  rename(Height = dec_height)

```

```{r, fig.width = 7, fig.height = 5}
 Q5_plot = planting_date %>%
  ggplot(aes(x = plant_date, y = respondent, group = respondent, color= Height)) +
  geom_point(size = 3) +
  geom_line(linewidth = 2) +
  scale_color_gradient2(midpoint = 6, mid = "steelblue4", low = "slategray1", high = "blue") +
  scale_x_date(limit= c(as.Date("2022-08-01"),as.Date("2022-12-01"))) +
  ylim(0,26) +
  theme_bw() +
  theme(plot.title = element_text(size = 20),
        axis.title.x = element_blank(),
       axis.title.y = element_blank(),
       axis.text.x = element_text(size = 15),
       axis.text.y = element_blank(),
       axis.ticks.y = element_blank()) +
  labs(title = "2022 Cover Crop Planting Dates")

Q5_plot
```




# 6. What Species did you plant
```{r}
Q6= data1 %>%
  separate_rows(cc_species, sep = ",") %>%
  count(cc_species, sort = TRUE) %>%
  rename(response = cc_species)
```

```{r, fig.width = 7, fig.height = 5}
species = Q6 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "forestgreen") +
  geom_text(aes(label= n), nudge_y= 0.75, size = 5) +
  theme_bw() +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,28), breaks = c(0,5,10,15,20,25)) +
  labs(title= "Cover Crop Species", y = "# of respondents") +
  coord_flip()

species
```

```{r}
ggsave("CCSpecies_2022.png", plot = species, height = 5, width = 7, dpi = 300)
```

# 7. Seeding rate(s)
```{r}
Q7= data1 %>%
  select(respondent,cc_rate,cc_type) %>%
  separate_rows(c(cc_rate,cc_type), sep = ",") %>%
  mutate(cc_rate = as.numeric(cc_rate)) %>%
  rename(response = cc_rate)

```

```{r, fig.width = 5, fig.height = 7}
rate = Q7 %>%
  ggplot(aes(x = response, y = cc_type)) +
  #geom_jitter(size=3) +
  geom_line(stat = "density") #+
  #geom_text(aes(label= response), nudge_y= 0.75, size = 5) +
  theme_bw() +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  #scale_y_continuous(limits= c(0,310), breaks = c(0,30,60,90,120,150,200,300)) +
  labs(title= "Cover Crop Rate", y = "# of respondents") 
  #coord_flip()

rate
```

```{r}
ggsave("CCSeedRate_2022.png", plot = Q7_plot, height = 5, width = 7, dpi = 300)
```

# 8. Planting method(s)
```{r}
Q8= data1 %>%
  count(Planting.method.s., sort = TRUE) %>%
  rename(response = Planting.method.s.) 
```

```{r, fig.height = 5, fig.width = 7}
method = Q8 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "azure4") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,10), breaks = c(0,5,10)) +
  labs(title= "Planting Method", y = "# of respondents") +
  coord_flip()

method
```

```{r}
ggsave("CCPlantMethod_2022.png", plot = method, height = 5, width = 7, dpi = 300)
```

# 9. Tillage
```{r}
q9= data1 %>%
  count(Tillage., sort = TRUE) %>%
  rename(response = Tillage.) 
```

```{r, fig.height = 5, fig.width = 7}
tillage = q9 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "saddlebrown") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Tillage", y = "# of respondents") +
  coord_flip()

tillage
```

```{r}
ggsave("CCTillage_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

# 10. Manure
## Number of respondents who applied manure
```{r}
q10.1= data1 %>%
  count(Manure.timing, sort = TRUE) %>%
  rename(response = Manure.timing) 
```

```{r, fig.height = 5, fig.width = 7}
manure1 = q10.1 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "tan4") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Manure", y = "# of respondents") +
  coord_flip()

manure1
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

## Manure application rates
### Liquid

### Dry

# 11. Seed Source
```{r}
q11= data1 %>%
  count(Seed.Source, sort = TRUE) %>%
  rename(response = Seed.Source) 
```

```{r, fig.height = 5, fig.width = 7}
seed_source = q11 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "darkorchid1") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Seed Source", y = "# of respondents") +
  coord_flip()

seed_source
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

## For bin run seed
### Seed cleaned

### Germ tested


# 12. Anticipated use
```{r}
q12= data1 %>%
  count(Cover.crop.use, sort = TRUE) %>%
  rename(response = Cover.crop.use) 
```

```{r, fig.height = 5, fig.width = 7}
CC_use = q12 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "red2") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Intended Cover Crop Use", y = "# of respondents") +
  coord_flip()

CC_use
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

# 13. Termination method/timing
```{r}
q13= data1 %>%
  count(Termination.method, sort = TRUE) %>%
  rename(response = Termination.method) 
```

```{r, fig.height = 5, fig.width = 7}
Termination = q11 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "orange1") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Seed Source", y = "# of respondents") +
  coord_flip()

Termination
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

# 14.

# 15.

# 16. Reason for planting cover crops
```{r}

```


```{r}
q16= data1 %>%
  count(Seed.Source, sort = TRUE) %>%
  rename(response = Seed.Source) 
```

```{r, fig.height = 5, fig.width = 7}
seed_source = q16 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "darkorchid1") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Seed Source", y = "# of respondents") +
  coord_flip()

seed_source
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```