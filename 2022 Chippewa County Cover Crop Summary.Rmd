---
title: "2022 Chippewa County Cover Crop Summary"
author: "Kolby Grint"
date: "2022-12-07"
output: html_document
---

```{r, echo= FALSE}
#loading packages
library(dplyr)
library(ggplot2)
library(car)
library(maps)
library(RColorBrewer)
```

```{r}
getwd()
#gettting data from local file
data1 = read.csv(file="2022 Cover Crop Survey_test1.csv")
```

```{r}
data1 = data1 %>%
  mutate(Township.s. = as.factor(Township.s.),
         Previous.crop.s. = as.factor(Previous.crop.s.),
         #Planting.date.start = as.Date(Planting.date.start),
         #Last.planting.date  = as.Date(Last.planting.date ),
         Species.planted = as.factor(Species.planted),
         Planting.method.s. = as.factor(Planting.method.s.),
         Tillage. = as.factor(Tillage),
         Manure.timing = as.factor(Manure.timing),
         Liquid.Manure.Rate = as.factor(Liquid.Manure.Rate),
         Solid.manure.rate = as.factor(Solid.manure.rate),
         Seed.Source = as.factor(Seed.Source),
         Bin.run.cleaned = as.factor(Bin.run.cleaned),
         Bin.run.germ = as.factor(Bin.run.germ),
         Cover.crop.use = as.factor(Cover.crop.use),
         Termination.method = as.factor(Termination.method))
str(data1)
```

# 1. What Chippewa County township(s) do you farm in?
```{r}
q1 = data1 %>%
  #mutate(Township.s. = as.factor(Township.s.)) %>%
  #filter(!is.na(Township.s.)) %>%
  count(Township.s., sort= TRUE) %>%
  rename("response" = "Township.s.")
```

```{r, fig.height = 5, fig.width = 7}
q1_plot = q1 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "cornflowerblue") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,10), breaks = c(0,5,10)) +
  labs(title= "Townships", y = "# of respondents") +
  coord_flip()

q1_plot
```

```{r}
ggsave("CCTownships_2022.png", plot = q1_plot, height = 5, width = 7, dpi = 300)
```


```{r}
#building a dataframe with chippewa county townships and approximate GPS locations 55017
townships = tribble(
  ~township, ~lat, ~long,
  'Sampson', 45.2356, -91.4639,
  'Birch Creek', 45.2309, -91.1932,
  'Lake Holcombe', 45.2223, -91.1178,
  'Ruby', 45.2492, -91.0040,
  'Auburn', 45.1425, -91.6077,
  'Bloomer', 45.1533, -91.4429,
  'Cleveland', 45.1386, -91.2647,
  'Estella', 45.1650, -91.1310,
  'Cooks Valley', 45.0706, -91.5910,
  'Woodmohr', 45.0854, -91.4176,
  'Eagle Point', 45.0584, -91.3895,
  'Anson', 45.0445, -91.2749,
  'Arthur', 45.0682, -91.1461,
  'Colburn', 45.1104, -90.9877,
  'Howard', 45.0088, -91.5893,
  'Tilden', 44.9877, -91.4526,
  'Goetz', 44.9733, -91.1517,
  'Delmar', 45.0097, -91.0250,
  'Wheaton', 44.9151, -91.5483,
  'Hallie', 44.8810, -91.3704,
  'Lafayette', 44.9262, -91.2743,
  'Sigel', 44.9226, -91.1457,
  'Edson', 44.9081, -91.0015 )
```

```{r}
wi_county= map_data("county","wisconsin")
```

```{r}
Chip_township = ggplot(wi_county, aes(x = long, y = lat, group= group)) +
  geom_polygon(fill= "steelblue2", colour = "black") +
  #coord_quickmap() +
  coord_fixed(xlim = c(44.8286,45.3579), ylim = c(-90.8381,-91.7253), 
  ratio = 1.3) +
  #theme_void() +
  theme(axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  axis.title = element_blank())

Chip_township
```

# 2. Total number of 2022 cropland acres & 3. Total number of 2022 fall cover crops planted
```{r}
#what do we want? 
#plot raw total cropland and total cover crop acres planted.
#average percent of total acres cover cropped for farms participating would be interesting.

```



# 4. Previous crops
```{r}
Q4 = data1 %>%
  count(Previous.crop.s., sort= TRUE) %>%
  rename(response = Previous.crop.s.) 
 
```

```{r}
data
```


```{r, fig.height = 5, fig.width = 7}
Q4_plot = Q4 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "gold3") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,10), breaks = c(0,5,10)) +
  labs(title= "Previous Crop(s)", y = "# of respondents") +
  coord_flip()

Q4_plot
```

```{r}
ggsave("PreviousCrop_2022.png", plot = q1_plot, height = 5, width = 7, dpi = 300)
```

# 5. 20222 cover crop planting date range
```{r}
data1 = data1 %>%
  mutate(Planting.date.start = as.Date(Planting.date.start, format = "%m/%d/%y"),
         Last.planting.date  = as.Date(Last.planting.date, format = "%m/%d/%y"))
```

```{r, fig.height = 5, fig.width = 7}
planting_date = data1 %>%
  ggplot() +
  geom_point(aes(x=Planting.date.start, y=Previous.crop.s., color=Species.planted))

planting_date
```

# 6. What Species did you plant
```{r}
q6= data1 %>%
  count(Species.planted, sort = TRUE) %>%
  rename(response = Species.planted) 
```

```{r, fig.height = 5, fig.width = 7}
species = q6 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "forestgreen") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Cover Crop Species", y = "# of respondents") +
  coord_flip()

species
```

```{r}
ggsave("CCSpecies_2022.png", plot = q1_plot, height = 5, width = 7, dpi = 300)
```

# 7. Seeding rate(s)
```{r, fig.height = 5, fig.width = 7}
rate = data1 %>%
  ggplot(aes(x= Species.planted, y= Seeding.rate.lbs, color = Planting.method.s.)) +
  geom_jitter(size= 3) +
  scale_y_continuous(limits = c(0,150), breaks = c(0,30,60,90,120,150)) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_text(size=15),
        axis.text = element_text(size = 12),
        plot.title = element_text(size = 20)) +
  labs(title= "Cover Crop Seeding Rate", y = "Seeding rate lbs") 
  #facet_grid(cols= vars(Species.planted)) +
  #coord_flip()

rate
```

```{r}
ggsave("CCSeedRate_2022.png", plot = q1_plot, height = 5, width = 7, dpi = 300)
```

# 8. Planting method(s)
```{r}
q8= data1 %>%
  count(Planting.method.s., sort = TRUE) %>%
  rename(response = Planting.method.s.) 
```

```{r, fig.height = 5, fig.width = 7}
method = q8 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "azure4") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,10), breaks = c(0,5,10)) +
  labs(title= "Planting Method", y = "# of respondents") +
  coord_flip()

method
```

```{r}
ggsave("CCPlantMethod_2022.png", plot = method, height = 5, width = 7, dpi = 300)
```

# 9. Tillage
```{r}
q9= data1 %>%
  count(Tillage., sort = TRUE) %>%
  rename(response = Tillage.) 
```

```{r, fig.height = 5, fig.width = 7}
tillage = q9 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "saddlebrown") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Tillage", y = "# of respondents") +
  coord_flip()

tillage
```

```{r}
ggsave("CCTillage_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

# 10. Manure
## Number of respondents who applied manure
```{r}
q10.1= data1 %>%
  count(Manure.timing, sort = TRUE) %>%
  rename(response = Manure.timing) 
```

```{r, fig.height = 5, fig.width = 7}
manure1 = q10.1 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "tan4") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Manure", y = "# of respondents") +
  coord_flip()

manure1
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

## Manure application rates
### Liquid

### Dry

# 11. Seed Source
```{r}
q11= data1 %>%
  count(Seed.Source, sort = TRUE) %>%
  rename(response = Seed.Source) 
```

```{r, fig.height = 5, fig.width = 7}
seed_source = q11 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "darkorchid1") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Seed Source", y = "# of respondents") +
  coord_flip()

seed_source
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

## For bin run seed
### Seed cleaned

### Germ tested


# 12. Anticipated use
```{r}
q12= data1 %>%
  count(Cover.crop.use, sort = TRUE) %>%
  rename(response = Cover.crop.use) 
```

```{r, fig.height = 5, fig.width = 7}
CC_use = q12 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "red2") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Intended Cover Crop Use", y = "# of respondents") +
  coord_flip()

CC_use
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

# 13. Termination method/timing
```{r}
q13= data1 %>%
  count(Termination.method, sort = TRUE) %>%
  rename(response = Termination.method) 
```

```{r, fig.height = 5, fig.width = 7}
Termination = q11 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "orange1") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Seed Source", y = "# of respondents") +
  coord_flip()

Termination
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```

# 14.

# 15.

# 16. Reason for planting cover crops
```{r}

```


```{r}
q16= data1 %>%
  count(Seed.Source, sort = TRUE) %>%
  rename(response = Seed.Source) 
```

```{r, fig.height = 5, fig.width = 7}
seed_source = q16 %>%
  ggplot(aes(x = response, y = n)) +
  geom_col(fill = "darkorchid1") +
  geom_text(aes(label= n), nudge_y= 0.5, size = 5) +
  theme(legend.position = "none",
        axis.title.x = element_text(size = 15),
        axis.title.y = element_blank(),
        axis.text = element_text(size = 15),
        plot.title = element_text(size = 20)) +
  scale_y_continuous(limits= c(0,20), breaks = c(0,5,10,15,20)) +
  labs(title= "Seed Source", y = "# of respondents") +
  coord_flip()

seed_source
```

```{r}
ggsave("CCManure1_2022.png", plot = tillage, height = 5, width = 7, dpi = 300)
```